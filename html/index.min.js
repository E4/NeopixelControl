/*
 Copyright (c) Emre Yucel
*/
var q=new Set(["tagName","element","children"]);function t(a,d=null){if(Array.isArray(a))for(let c=0;c<a.length;c++)u(a[c],d,c);else u(a,d)}function v(a,d){function c(){return f}function h(g){if(g==f)return f;f=g;t(a,null);return f}var f=a[d];return{set:q.has(d)?c:h,get:function(){return f}}}
function u(a,d,c=null){if(a!=null){a.children==null&&(a.children=[]);if(!a.element){a.element=document.createElement(a.tagName);for(var h in a)Object.defineProperty(a,h,v(a,h));d&&x(a.element,d,c)}d&&a.element.parentElement!=d?x(a.element,d,c):d&&c!=null&&d.children[c]!=a.element&&x(a.element,d,c);a.children==null&&(a.children=[]);d={};for(var f in a)if(!q.has(f))if(f=="text")if(c=a.element,h=a.text,c.childNodes.length>0)for(let l=0;l<c.childNodes.length;l++){if(c.childNodes[l].nodeType==3){c.childNodes[l].textContent!=
h&&(c.childNodes[l].textContent=h);break}}else c.innerText!=h&&(c.innerText=h);else f=="class"?a.element.className!=a["class"]&&(a.element.className=a["class"]):f.startsWith("on-")?d[f.substring(3)]=a[f]:a.element[f]!=a[f]&&(a.element[f]=a[f]);f=a.element;c=f.h;c||(f.h=c={});for(var g in c)g in d&&c[g]==d[g]||g in d&&c[g]==d[g]||(f.removeEventListener(g,c[g]),delete c[g]);for(let l in d)l in c||(f.addEventListener(l,d[l]),c[l]=d[l]);g=a.element.g;var k;g||(a.element.g=g=[]);if("children"in a)for(var n in a.children)u(a.children[n],
a.element,n),g.indexOf(a.children[n])==-1&&g.push(a.children[n]);for(n=g.length-1;n>=0;n--)a.children.indexOf(g[n])==-1&&(k=g.splice(n,1)[0])&&k.element.remove()}}function x(a,d,c=null){c==null||c>=d.children.length?d.appendChild(a):d.insertBefore(a,d.children[c])}function y(a,d,c,h,f){a={tagName:a,"class":d,text:c,children:f};for(let g in h)a[g]=h[g];return a}var z=(a,d=null,c=[])=>y("div",a,d,null,c),A=(a,d=null,c=null)=>y("button",a,d,c,[]);
function B(a,d,c,h=[]){var f={tagName:"input","class":a,type:d,children:h};for(let k in c)f[k]=c[k];var g=f["on-change"];f["on-change"]=k=>{f.value=k.target.value;g&&g(k)};return f}
function C(){function a(b){if(!(b instanceof ArrayBuffer))if(b instanceof Uint8Array)b=b.buffer.slice(b.byteOffset,b.byteOffset+b.byteLength);else throw Error("Input must be ArrayBuffer or Uint8Array");if(b.byteLength%32!==0)throw Error(`Invalid blob length ${b.byteLength}, not multiple of ${32}`);return b}function d(b){const e=new DataView(b);b=b.byteLength/32;for(let m=0;m<b;m++)c(e,m*32)}function c(b,e){let m=z("csr","",[f(b.getUint8(e+0),b.getUint8(e+1),b.getUint8(e+2)),f(b.getUint8(e+3),b.getUint8(e+
4),b.getUint8(e+5)),f(b.getUint8(e+6),b.getUint8(e+7),b.getUint8(e+8)),f(b.getUint8(e+9),b.getUint8(e+10),b.getUint8(e+11)),f(b.getUint8(e+12),b.getUint8(e+13),b.getUint8(e+14)),f(b.getUint8(e+15),b.getUint8(e+16),b.getUint8(e+17)),h("Position Offset",g,b.getUint16(e+18,1)),h("Position Speed",n,b.getInt8(e+20)),h("Position Delay",k,b.getUint8(e+23)),h("Color Offset",k,b.getUint8(e+21)),h("Color Speed",k,b.getUint8(e+22)),h("Color Delay",k,b.getUint8(e+24)),h("Repeat",k,b.getUint8(e+25)),h("Limit Low",
g,b.getUint16(e+26,1)),h("Limit High",g,b.getUint16(e+28,1)),A("r","remove",{onclick:function(){let p=r.indexOf(m);p!=-1&&r.splice(p,1);t(w,null)}})]);r.push(m);t(w,null)}function h(b,e,m){e=[...e];e[2].value=m.toString();m=[B(...e)];b={tagName:"label","class":"",text:b,children:m};for(let p in null)b[p]=null[p];return b}function f(b,e,m){var p=[...l];p[2].value="#"+b.toString(16).padStart(2,"0")+e.toString(16).padStart(2,"0")+m.toString(16).padStart(2,"0");return B(...p)}const g=["","number",{min:"0",
max:"65535",value:"0"}],k=["","number",{min:"0",max:"255",value:"0"}],n=["","number",{min:"-128",max:"127",value:"0"}],l=["","color",{value:"#000000"}];let r,w=z("",null,r=[]),D=z("",null,[w,A("a","add",{onclick:function(){d(new ArrayBuffer(32))}})]);t(D,document.body);(async function(){var b=await fetch("/bin");if(!b.ok){const e=await b.text().catch(()=>"");throw Error(`GET /bin failed: ${b.status} ${b.statusText}${e?` \u2014 ${e}`:""}`);}b=await b.arrayBuffer();return b.byteLength===0?[]:a(b)})().then(d)}
window.addEventListener("load",()=>new C);
